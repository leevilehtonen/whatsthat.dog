(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{234:function(e,t){},246:function(e){e.exports={0:"Newfoundland",1:"Greater swiss mountain dog",2:"Brabancon griffon",3:"Groenendael",4:"Sussex spaniel",5:"Afghan hound",6:"Border terrier",7:"Bedlington terrier",8:"Bernese mountain dog",9:"Welsh springer spaniel",10:"Norwegian elkhound",11:"Leonberg",12:"Brittany spaniel",13:"Sealyham terrier",14:"German shepherd",15:"Bluetick",16:"Silky terrier",17:"Bloodhound",18:"Toy poodle",19:"Kelpie",20:"Standard poodle",21:"Schipperke",22:"Papillon",23:"Shetland sheepdog",24:"Rottweiler",25:"Vizsla",26:"Shih-tzu",27:"Ibizan hound",28:"Flat-coated retriever",29:"Wire-haired fox terrier",30:"Japanese spaniel",31:"Boston bull",32:"Border collie",33:"Tibetan mastiff",34:"Tibetan terrier",35:"Maltese dog",36:"Miniature pinscher",37:"Yorkshire terrier",38:"Saluki",39:"Lhasa",40:"Mexican hairless",41:"American staffordshire terrier",42:"African hunting dog",43:"Clumber",44:"Great pyrenees",45:"Dhole",46:"Golden retriever",47:"Italian greyhound",48:"Lakeland terrier",49:"Staffordshire bullterrier",50:"Curly-coated retriever",51:"Dandie dinmont",52:"Irish water spaniel",53:"Collie",54:"Miniature poodle",55:"Toy terrier",56:"Weimaraner",57:"Pekinese",58:"Malinois",59:"French bulldog",60:"Appenzeller",61:"Doberman",62:"Cardigan",63:"Siberian husky",64:"English setter",65:"English springer",66:"Redbone",67:"Scottish deerhound",68:"Basset",69:"German short-haired pointer",70:"Pomeranian",71:"Malamute",72:"Keeshond",73:"Komondor",74:"Basenji",75:"Great dane",76:"Beagle",77:"Affenpinscher",78:"Irish terrier",79:"Pug",80:"Eskimo dog",81:"Kerry blue terrier",82:"Dingo",83:"Black-and-tan coonhound",84:"Entlebucher",85:"English foxhound",86:"Chesapeake bay retriever",87:"Rhodesian ridgeback",88:"Airedale",89:"Irish setter",90:"Bull mastiff",91:"Cairn",92:"Boxer",93:"Norwich terrier",94:"Standard schnauzer",95:"Chihuahua",96:"Saint bernard",97:"Gordon setter",98:"Walker hound",99:"Labrador retriever",100:"Bouvier des flandres",101:"Miniature schnauzer",102:"Briard",103:"Australian terrier",104:"Samoyed",105:"Whippet",106:"Blenheim spaniel",107:"Giant schnauzer",108:"Soft-coated wheaten terrier",109:"Cocker spaniel",110:"West highland white terrier",111:"Kuvasz",112:"Chow",113:"Irish wolfhound",114:"Scotch terrier",115:"Borzoi",116:"Pembroke",117:"Otterhound",118:"Old english sheepdog",119:"Norfolk terrier"}},271:function(e,t,a){e.exports=a(585)},276:function(e,t,a){},501:function(e,t){},502:function(e,t){},504:function(e,t){},536:function(e,t){},537:function(e,t){},583:function(e,t){},584:function(e,t){},585:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),i=a(90),o=a.n(i),c=(a(276),a(13)),l=a(50),s=function(e){var t=e.isOpen;return r.a.createElement("div",{className:"navbar-menu "+(t?"is-active":"")},r.a.createElement("div",{className:"navbar-end"},r.a.createElement("a",{className:"navbar-item",href:"https://www.github.com/leevilehtonen/whatsthat.dog"},"Project"),r.a.createElement(l.b,{to:"/about",className:"navbar-item",activeClassName:"is-active"},"About")))},u=function(){var e=Object(n.useState)(!1),t=Object(c.a)(e,2),a=t[0],i=t[1];return r.a.createElement("nav",{className:"navbar animated slideInDown faster"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement("span",{className:"navbar-burger burger "+(a?"is-active":""),onClick:function(){return i(!a)}},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null))),r.a.createElement(s,{isOpen:a})))},d=function(e){var t=e.children;return r.a.createElement("div",{className:"hero-body"},t)},m=function(){return r.a.createElement("footer",{className:"hero-foot footer has-text-centered"},r.a.createElement("p",null,"\xa9 Leevi Lehtonen 2019"))},h=a(41),f=a(18),p=a.n(f),b=a(30),v=a(93),E=a(21),g=a(237),w=a.n(g),y=function(e){var t=e.src,a=e.setCanvas,i=Object(n.useState)({}),o=Object(c.a)(i,2),l=o[0],s=o[1],u=Object(n.useState)(null),d=Object(c.a)(u,2),m=d[0],h=d[1],f=function(){var e=Object(b.a)(p.a.mark(function e(t){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:m&&t.width&&t.height&&(n=v(m,t),a(n));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),v=function(e,t){var a=document.createElement("canvas"),n=e.naturalWidth/e.width,r=e.naturalHeight/e.height;return a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(e,t.x*n,t.y*r,t.width*n,t.height*r,0,0,t.width,t.height),a};return r.a.createElement("div",{className:"cropwindow"},t&&r.a.createElement(w.a,{src:t,crop:l,onChange:function(e){s(e)},onImageLoaded:function(e){h(e),a(function(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height),t}(e))},onComplete:function(e){f(e)}}))},N=a(16),O=function(e){var t=e.cloneNode();return t.getContext("2d").drawImage(e,0,0),t},k=function(e){var t=e.canvas,a=e.predictResult,i=Object(n.useRef)(null),o=Object(n.useRef)(null),l=Object(n.useState)(O(t)),s=Object(c.a)(l,1)[0],u=Object(n.useState)(O(t)),d=Object(c.a)(u,1)[0];return Object(n.useEffect)(function(){o.current.hasChildNodes()?o.current.replaceChild(d,o.current.firstChild):o.current.appendChild(d),i.current.hasChildNodes()?i.current.replaceChild(s,i.current.firstChild):i.current.appendChild(s)},[d,s]),r.a.createElement("div",{className:"resultwindow"},!a&&r.a.createElement("progress",{className:"progress is-small is-dark",max:"100"}),r.a.createElement("div",{className:"columns is-gapless is-hidden-touch"},r.a.createElement(E.Animated,{animationIn:"fadeIn",animationOut:"fadeOut",isVisible:!0,animationInDuration:500,className:"column"},r.a.createElement("div",{className:"resultwindow-canvas",ref:i})),r.a.createElement(E.Animated,{animationIn:"fadeInLeft",animationOut:"fadeOutLeft",isVisible:!!a,animationInDuration:500,className:"column"},r.a.createElement(N.d,{width:s.width,height:"100%"},r.a.createElement(N.b,{data:a.slice(0,5),layout:"vertical",margin:{top:20,right:20,left:40,bottom:20}},r.a.createElement(N.g,{dataKey:"Breed",type:"category"}),r.a.createElement(N.f,{type:"number"},r.a.createElement(N.c,{value:"Probability",offset:-10,position:"insideBottom"})),r.a.createElement(N.e,null),r.a.createElement(N.a,{dataKey:"Probability",stroke:"#2f0010",fill:"#8a5060"}))))),r.a.createElement("div",{className:"is-hidden-desktop"},r.a.createElement(E.Animated,{animationIn:"fadeIn",animationOut:"fadeOut",isVisible:!0,animationInDuration:500},r.a.createElement("div",{className:"resultwindow-canvas",ref:o})),r.a.createElement(E.Animated,{animationIn:"fadeIn",animationOut:"fadeOut",isVisible:!!a,animationInDuration:500},r.a.createElement(N.d,{width:d.width,height:400},r.a.createElement(N.b,{data:a.slice(0,5),layout:"vertical",margin:{top:20,right:20,left:40,bottom:20}},r.a.createElement(N.g,{dataKey:"Breed",type:"category"}),r.a.createElement(N.f,{type:"number"},r.a.createElement(N.c,{value:"Probability",offset:-10,position:"insideBottom"})),r.a.createElement(N.e,null),r.a.createElement(N.a,{dataKey:"Probability",stroke:"#2f0010",fill:"#8a5060"}))))))},C=a(37),x=a(246),j=function(){var e=Object(b.a)(p.a.mark(function e(){var t,a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.d("https://s3-eu-west-1.amazonaws.com/ai-data-storage/serve/model51205/model.json");case 2:return t=e.sent,a=t.predict(C.g([1,224,224,3])),e.next=6,a.data();case 6:return a.dispose(),e.abrupt("return",t);case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),I=function(e){var t=C.a.fromPixels(e),a=C.c.resizeBilinear(t,[224,224]),n=C.b(a,C.f(255));return C.e(n,[-1,224,224,3])},S=function(e,t){return e.predict(t,{batchSize:1}).arraySync()[0].map(function(e,t){return{Breed:x[t],Probability:e,index:t}}).sort(function(e,t){return t.Probability-e.Probability})},B=function(e){var t=e.open,a=e.onCancelClick,i=e.src,o=e.model,l=Object(n.useState)(null),s=Object(c.a)(l,2),u=s[0],d=s[1],m=Object(n.useState)("CROP"),h=Object(c.a)(m,2),f=h[0],v=h[1],g=Object(n.useState)(null),w=Object(c.a)(g,2),N=w[0],O=w[1],C=function(){var e=Object(b.a)(p.a.mark(function e(){var t,a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=function(){return(a=Object(b.a)(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=S(o,I(u)),O(t);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},t=function(){return a.apply(this,arguments)},v("RESULT"),t();case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return r.a.createElement(E.Animated,{animationIn:"fadeIn",animationOut:"fadeOut",isVisible:t},r.a.createElement("div",{className:"modal animated is-active"},r.a.createElement("div",{className:"modal-background",onClick:function(){return a()}}),r.a.createElement("div",{className:"modal-card"},r.a.createElement("header",{className:"modal-card-head"},r.a.createElement("p",{className:"modal-card-title"},"CROP"===f?"Crop image":"Prediction results")),r.a.createElement("section",{className:"modal-card-body"},"CROP"===f&&r.a.createElement(y,{src:i,setCanvas:d}),"RESULT"===f&&r.a.createElement(k,{canvas:u,predictResult:N})),r.a.createElement("footer",{className:"modal-card-foot"},"CROP"===f&&r.a.createElement("button",{className:"button is-inverted "+(null===o?"is-loading":""),onClick:function(){return C()}},"Predict"),r.a.createElement("button",{className:"button is-primary",onClick:function(){return a()}},"CROP"===f?"Cancel":"Finish")))))},P=function(e){var t=e.text,a=e.type,n=e.visible,i=e.setVisible;return r.a.createElement(E.Animated,{animationIn:"fadeInUp",animationOut:"fadeOut",animationInDuration:500,animationOutDuration:500,isVisible:n,className:"notification-container"},r.a.createElement("div",{className:"notification "+a},r.a.createElement("button",{className:"delete",onClick:function(){return i(!1)}}),r.a.createElement("p",{className:"is-size-5 "+("is-danger"===a?"":"has-text-black")},t)))},A=function(){var e=Object(n.useState)(!1),t=Object(c.a)(e,2),a=t[0],i=t[1],o=Object(n.useState)(null),l=Object(c.a)(o,2),s=l[0],u=l[1],d=Object(n.useState)(null),m=Object(c.a)(d,2),h=m[0],f=m[1],g=Object(n.useState)({visible:!1,text:"",type:"is-white"}),w=Object(c.a)(g,2),y=w[0],N=w[1],O=function(){var e=Object(b.a)(p.a.mark(function e(){var t;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==h){e.next=17;break}return e.prev=1,N({visible:!0,text:"Initializing AI model in background. First time might take time.",type:"is-white"}),e.next=5,new Promise(function(e,t){return setTimeout(function(){return e()},500)});case 5:return e.next=7,j();case 7:t=e.sent,N({visible:!1}),f(t),setTimeout(function(){return N({visible:!0,text:"AI model was successfully loaded.",type:"is-success"})},500),setTimeout(function(){return N({visible:!1})},3e3),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),N({visible:!0,text:"Error fetching model from server. Try clearing cache and hard reloading the website. Please also check that your connection is up and running.",type:"is-danger"});case 17:case"end":return e.stop()}},e,null,[[1,14]])}));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container page"},r.a.createElement(E.Animated,{animationIn:"fadeIn"},r.a.createElement("h1",{className:"title is-spaced"},"What's that dog?"),r.a.createElement("h2",{className:"subtitle is-spaced is-4"},"Did you run into some cool dog and you want now to find out which breed it was? Let this AI powered web application help you to find out. All you have to do is load a picture of the cool dog and the AI will do the rest."),r.a.createElement("div",{className:"file is-boxed is-white"},r.a.createElement("label",{className:"file-label"},r.a.createElement("input",{className:"file-input",type:"file",name:"dog",onChange:function(e){var t=new FileReader;t.addEventListener("load",function(){u(t.result),i(!0)}),t.readAsDataURL(e.target.files[0]),e.target.value=""},onClick:function(){return O()}}),r.a.createElement("span",{className:"file-cta"},r.a.createElement("span",{className:"file-icon"},r.a.createElement(v.a,{icon:"upload"})),r.a.createElement("span",{className:"file-label is-size-4"},"Choose an image file..."))))),s&&r.a.createElement(B,{open:a,src:s,model:h,onCancelClick:function(){i(!1),u(null)},setNotification:N}),y.visible&&r.a.createElement(P,{text:y.text,type:y.type,visible:y.visible,setVisible:function(){return N({visible:!1})}}))},R=function(){return r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"title is-spaced"},"whatsthat.dog"),r.a.createElement("h2",{className:"subtitle is-spaced is-4"},"Whatsthat.dog is a small hobby POC kind of project to keep deep learning skills up to date and also to explore running a machine learning model in a browser environment with Tensorflow JavaScript. Please do contribute if you are interested by making a pull request to GitHub, and contact me if you have any questions."),r.a.createElement("div",{className:"buttons"},r.a.createElement(l.b,{to:"/",className:"button is-large",activeClassName:"is-active"},r.a.createElement("span",{class:"icon"},r.a.createElement(v.a,{icon:"chevron-left"})),r.a.createElement("span",null," Back to app"))))},z=a(68),L=a(141),D=function(){return z.b.add(L.b,L.a),r.a.createElement("div",{className:"App"},r.a.createElement(l.a,null,r.a.createElement(u,null),r.a.createElement("section",{className:"hero is-fullheight-with-navbar"},r.a.createElement(d,null,r.a.createElement(h.a,{path:"/",exact:!0,component:A}),r.a.createElement(h.a,{path:"/about",component:R})),r.a.createElement(m,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[271,1,2]]]);
//# sourceMappingURL=main.d85fbf69.chunk.js.map